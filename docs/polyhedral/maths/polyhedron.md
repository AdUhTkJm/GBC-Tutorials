# 多面体

这篇文章介绍一些与多面体有关的知识. 阅读本文前, 你需要懂得线性代数的基础内容, 并最好已经读过本站的[单纯形法](simplex.md)教程.

你可以不必从头到尾读完这篇文章. 本站的其他多面体优化教程中会有大量链接, 将你引向本文对应的部分.

## 多面体的定义

<a name="def-1"></a>
**定义 1.** 一个**多面体**是形如 $\{ x\in\mathbb{R}^n \mid Ax\leq b \}$ 的集合, 其中 $A$ 是一个 $m$ 行 $n$ 列的矩阵. 这称为多面体的 **H-表示**.

例如, 一个三角形是一个 2 维的多面体. 拿顶点在 $(0, 0)$, $(0, 1)$, $(1, 0)$ 的直角三角形为例, 我们可以将它写作:

$$
\begin{align*}
-x &\leq 0 \\ 
-y &\leq 0 \\
x+y &\leq 1
\end{align*}
$$

换成矩阵的写法, 则是

$$
\begin{pmatrix}
-1 & 0 \\
0 & -1 \\
1 & 1
\end{pmatrix}
\begin{pmatrix}
x \\ y
\end{pmatrix}
\leq
\begin{pmatrix}
0 \\ 0 \\ 1
\end{pmatrix}
$$

所以, 我们可以将 $Ax\leq b$ 看成是 $m$ 个不等式构成的不等式组.

我们再看看前面的三个不等式. $-x \leq 0$ 说明整个三角形在 x 轴之上; $-y \leq 0$ 说明整个三角形在 y 轴右边; $x+y\leq 1$ 说明三角形在 $y=1-x$ 这条线的下面. 换言之, 每个不等式都把整个二维空间切割成了两半, 而整个三角形都在其中的半边. 因此, 每个不等式都指明了一个**半空间** (*halfspace*); 这就是 **H-表示**中字母 H 的来源.

值得注意的是, 矩阵 $A$ 的行向量是每个半空间的分界面的法向量. 证明是显然的.

**定义 2.** 多面体的**顶点**是无法由多面体内的其他两点[凸组合](simplex.md#def-2)而成的点.

等价地, 对于一个 $d$ 维多面体, 顶点是使得 $Ax\leq b$ 中的 $d$ 个线性无关的不等式取得等号的点. 这些不等式被称为在顶点处**活跃** (*active*) 的不等式. 在单纯形法中, 我们证明了基解和顶点一一对应, 那里的证明方法和这里是类似的.

**证明.** 假设 $V$ 使得 $d$ 个线性无关的不等式取得等号. 假如存在 $V_1$, $V_2$ 与 $\lambda\in [0,1]$ 使得 $V=\lambda V_1 + (1-\lambda)V_2$, 那么 $V_1$, $V_2$ 在那些不等式处一定也会取得等号. 由于这些等式线性无关, 所以只有唯一解, 进而 $V = V_1 = V_2$.

假设 $V$ 使得 $m < d$ 个线性无关的不等式取得等号, 那么满足这 $m$ 个等式的向量至少构成了 $d-m$ 维空间. 我们只需要在其中取合适的 $v$, 使得 $V+\varepsilon v$ 和 $V - \varepsilon v$ 都在多面体内部, 就能说明 $V$ 不是顶点.

**定义 3.** 一个点集的**凸包** (*convex hull*) 是最小的包含它们的凸集. 一个向量集合 $\{ v_i \}$ 的**锥包** (*conical hull*) 是

$$
\left\{ \sum \lambda_i v_i \mid \lambda_i\geq 0 \right\}
$$

<a name="def-1'"></a>
**定义 1'.** 一个多面体是它顶点的凸包和边的锥包的并.

这被称为多面体的 **V-表示**, 其中 V 来自顶点 (*vertex*).

这个定义和[定义 1](#def-1) 是等价的, 这被称为 Minkowski-Weyl 定理. 我们在这里只说明比较简单的情况: 多面体 $\{x \mid Ax \geq 0\}$ 和 $\{x \mid x = R\lambda , \lambda \geq 0\}$ 是等价的 (后者就是换了个写法的锥包, 其中 $R$ 是 $v_i$ 构成的矩阵).

想从 V-表示转换到 H-表示, 就意味着我们需要在给定 $R$ 的情况下, 消去那些参数 $\lambda$, 从而得到 $A$. 这可以直接使用 Fourier-Motzkin 消元法完成. 它不会引入新的常数, 所以最终的结果确实可以写作 $Ax\leq 0$ 的形式. 这就完成了一个方向的证明.

我们称上面所描述的 $(A, R)$ 是一个**双重描述对** (*double description pair*), 或者直接称为 **DD 对**. 严格来说, $(A, R)$ 是一个 DD 对, 当且仅当 $\{x\mid Ax \geq 0\} = \{x \mid x = R\lambda, \lambda\geq 0\}$.

对于另一个方向, 我们声明: 如果 $(A, R)$ 是一个 DD 对, 那么 $(R^T, A^T)$ 也是. 证明如下:

设原本的锥体是 $C$, 我们定义它的**极锥** $C^\circ$:

$$
C^\circ = \{ y\mid \forall x\in C, \langle y, x\rangle \leq 0\}
$$

既然我们知道 $C$ 中的每个元素都是 $R$ 列向量的线性组合, 那么要让 $\langle y, x \rangle \leq 0$, 只需要让它和每个列向量的内积都不大于零即可. 也就是说, $C^\circ = \{ y\mid \forall R_i, \langle y, R_i\rangle \leq 0\}$, 或者换种写法, $C^\circ = \{ y\mid R^Ty \leq 0 \}$.

此外, 根据 $C^\circ$ 的定义, 它的边是 $A$ 的行向量, 所以根据[定义 1'](#def-1'), 它可以写作 $\{y\mid y = -A^T\lambda, \lambda\geq 0\}$. 这就说明了 $(R^T, A^T)$ 是一个 DD 对.

所以在给定 $A$ 的情况下, 我们可以直接利用刚刚的方法来求出 $R$.

这种转换可以在只知道多面体 $P = \{x\mid Ax\leq b\}$ 的情况下, 给出多面体的顶点, 所以十分有用. 然而, 我们刚刚的转换方式主要依靠 F-M 消元法, 而它最坏是指数级的. 我们需要更高效的算法.

## 双重描述法


